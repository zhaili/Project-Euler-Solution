(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     13066,        365]
NotebookOptionsPosition[     12246,        333]
NotebookOutlinePosition[     12587,        348]
CellTagsIndexPosition[     12544,        345]
WindowFrame->Normal
ContainsDynamic->False*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"RSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "n", "]"}], "==", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"n", "-", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"n", "-", "2"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"n", "-", "3"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"a", "[", "1", "]"}], "==", "1"}], ",", 
     RowBox[{
      RowBox[{"a", "[", "2", "]"}], "\[Equal]", "1"}], ",", 
     RowBox[{
      RowBox[{"a", "[", "3", "]"}], "\[Equal]", "1"}]}], "}"}], ",", 
   RowBox[{"a", "[", "n", "]"}], ",", "n"}], "]"}]], "Input",
 CellChangeTimes->{{3.44850911878125*^9, 3.448509121953125*^9}, {
  3.44850926540625*^9, 3.448509278140625*^9}, {3.44850934640625*^9, 
  3.4485094521875*^9}, {3.448509485703125*^9, 3.448509487546875*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"n_", "/;", 
     RowBox[{"n", ">", "3"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", "[", "n", "]"}], "=", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"n", "-", "1"}], "]"}], "+", 
     RowBox[{"a", "[", 
      RowBox[{"n", "-", "2"}], "]"}], "+", 
     RowBox[{"a", "[", 
      RowBox[{"n", "-", "3"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "1", "]"}], "=", "1"}], ";", 
  RowBox[{
   RowBox[{"a", "[", "2", "]"}], "=", "1"}], ";", 
  RowBox[{
   RowBox[{"a", "[", "3", "]"}], "=", "1"}], ";", 
  "\[IndentingNewLine]"}]}], "Input",
 CellChangeTimes->{{3.4485095599375*^9, 3.448509647796875*^9}, {
  3.448509752625*^9, 3.44850976278125*^9}, {3.448509965921875*^9, 
  3.448509992765625*^9}, {3.448510052484375*^9, 3.448510081578125*^9}, {
  3.448510230328125*^9, 3.448510230390625*^9}, {3.44851030090625*^9, 
  3.448510302421875*^9}, {3.448510476125*^9, 3.448510476796875*^9}, {
  3.448511178296875*^9, 3.44851118228125*^9}, {3.44851125903125*^9, 
  3.448511278609375*^9}, {3.448512476078125*^9, 3.448512479921875*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"n_", "/;", 
    RowBox[{"OddQ", "[", "n", "]"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"NestWhile", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "+", "1"}], "&"}], ",", "4", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[LessEqual]", "30000"}], "&&", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"l", "[", 
           RowBox[{"[", "#", "]"}], "]"}], ",", "n"}], "]"}], "\[NotEqual]", 
        "0"}]}], "&"}]}], "]"}], "\[Equal]", 
   "30001"}]}], "\[IndentingNewLine]", 
 RowBox[{"f", "[", "25", "]"}]}], "Input",
 CellChangeTimes->{{3.44850976515625*^9, 3.448509768046875*^9}, {
   3.448509804234375*^9, 3.448509928453125*^9}, {3.448509978234375*^9, 
   3.44850999965625*^9}, {3.4485100554375*^9, 3.448510086078125*^9}, {
   3.4485102346875*^9, 3.448510237625*^9}, {3.4485103051875*^9, 
   3.448510307515625*^9}, {3.448510480625*^9, 3.44851048153125*^9}, 
   3.448510651109375*^9}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.448509911671875*^9, 3.44850992871875*^9}, {
   3.448509982890625*^9, 3.4485100000625*^9}, {3.448510061515625*^9, 
   3.448510088578125*^9}, {3.448510238046875*^9, 3.448510240796875*^9}, 
   3.4485103079375*^9, {3.448510481921875*^9, 3.44851048434375*^9}, 
   3.448510653484375*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.448509915609375*^9, 3.44850991690625*^9}, {
  3.448511170890625*^9, 3.448511174390625*^9}, {3.448512467125*^9, 
  3.448512473453125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Mod", "[", 
    RowBox[{
     RowBox[{"a", "[", "#", "]"}], ",", "27"}], "]"}], "&"}], "/@", 
  RowBox[{"Range", "[", "300", "]"}]}]], "Input",
 CellChangeTimes->{{3.448512644421875*^9, 3.448512654203125*^9}, {
  3.44851269946875*^9, 3.44851269959375*^9}, {3.448512742046875*^9, 
  3.448512742390625*^9}, {3.448513313828125*^9, 3.44851332778125*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{
    RowBox[{"n_", "/;", 
     RowBox[{"OddQ", "[", "n", "]"}]}], ",", 
    RowBox[{"a_:", "1"}], ",", 
    RowBox[{"b_:", "1"}], ",", 
    RowBox[{"c_:", "3"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{"c", "\[Equal]", "0"}], ",", "False", ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"a", "\[Equal]", "1"}], "&&", 
     RowBox[{"b", "\[Equal]", "1"}], "&&", 
     RowBox[{"c", "\[Equal]", "1"}]}], ",", "True", ",", 
    "\[IndentingNewLine]", "True", ",", 
    RowBox[{"f", "[", 
     RowBox[{"n", ",", "b", ",", "c", ",", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"a", "+", "b", "+", "c"}], ",", "n"}], "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"NestList", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"NestWhile", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "+", "2"}], "&"}], ",", 
      RowBox[{"#1", "+", "2"}], ",", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"f", "[", "#", "]"}]}], "&"}]}], "]"}], "&"}], ",", "27", ",",
    "3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.4485133565625*^9, 3.4485133874375*^9}, {
  3.44851342184375*^9, 3.448514097515625*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"27", ",", "81", ",", "91", ",", "103"}], "}"}]], "Output",
 CellChangeTimes->{{3.448513555671875*^9, 3.44851359928125*^9}, {
  3.448513713625*^9, 3.4485137625625*^9}, {3.448513828078125*^9, 
  3.44851402696875*^9}, {3.44851406721875*^9, 3.448514098171875*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", "[", 
   RowBox[{"n_", "/;", 
    RowBox[{"OddQ", "[", "n", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "=", "1"}], ",", 
      RowBox[{"b", "=", "1"}], ",", 
      RowBox[{"c", "=", "3"}], ",", "d"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"c", "\[NotEqual]", "0"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "\[NotEqual]", "1"}], "||", 
          RowBox[{"b", "\[NotEqual]", "1"}], "||", 
          RowBox[{"c", "\[NotEqual]", "1"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d", "=", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"a", "+", "b", "+", "c"}], ",", "n"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"a", "=", "b"}], ";", "\[IndentingNewLine]", 
        RowBox[{"b", "=", "c"}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", "d"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"c", "\[Equal]", "0"}], ",", "False", ",", "True"}], "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NestList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NestWhile", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "+", "2"}], "&"}], ",", 
       RowBox[{"#1", "+", "2"}], ",", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"g", "[", "#", "]"}]}], "&"}]}], "]"}], "&"}], ",", "27", 
    ",", 
    RowBox[{"124", "-", "1"}]}], "]"}], "//", "Timing"}]}], "Input",
 CellChangeTimes->{{3.4485141976875*^9, 3.448514214046875*^9}, {
  3.44851424734375*^9, 3.448514537828125*^9}, {3.4485220604375*^9, 
  3.448522119125*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"66.844`", ",", 
   RowBox[{"{", 
    RowBox[{
    "27", ",", "81", ",", "91", ",", "103", ",", "135", ",", "163", ",", 
     "189", ",", "199", ",", "203", ",", "221", ",", "243", ",", "247", ",", 
     "273", ",", "297", ",", "305", ",", "309", ",", "351", ",", "371", ",", 
     "377", ",", "397", ",", "405", ",", "421", ",", "455", ",", "459", ",", 
     "489", ",", "513", ",", "515", ",", "551", ",", "559", ",", "567", ",", 
     "597", ",", "609", ",", "621", ",", "637", ",", "663", ",", "675", ",", 
     "721", ",", "729", ",", "741", ",", "757", ",", "779", ",", "783", ",", 
     "815", ",", "819", ",", "837", ",", "883", ",", "891", ",", "915", ",", 
     "927", ",", "945", ",", "991", ",", "995", ",", "999", ",", "1001", ",", 
     "1015", ",", "1021", ",", "1053", ",", "1079", ",", "1087", ",", "1105", 
     ",", "1107", ",", "1113", ",", "1123", ",", "1131", ",", "1133", ",", 
     "1141", ",", "1161", ",", "1183", ",", "1189", ",", "1191", ",", "1199", 
     ",", "1215", ",", "1235", ",", "1237", ",", "1263", ",", "1269", ",", 
     "1323", ",", "1339", ",", "1351", ",", "1365", ",", "1377", ",", "1393", 
     ",", "1421", ",", "1431", ",", "1467", ",", "1485", ",", "1521", ",", 
     "1525", ",", "1539", ",", "1543", ",", "1545", ",", "1547", ",", "1567", 
     ",", "1593", ",", "1609", ",", "1647", ",", "1651", ",", "1653", ",", 
     "1677", ",", "1701", ",", "1729", ",", "1751", ",", "1753", ",", "1755", 
     ",", "1769", ",", "1791", ",", "1793", ",", "1799", ",", "1807", ",", 
     "1809", ",", "1827", ",", "1855", ",", "1863", ",", "1873", ",", "1883", 
     ",", "1885", ",", "1911", ",", "1917", ",", "1919", ",", "1957", ",", 
     "1971", ",", "1985", ",", "1989", ",", "2009"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.44851441646875*^9, 3.448514446578125*^9}, {
   3.448514479359375*^9, 3.4485145320625*^9}, 3.448514608203125*^9, {
   3.448522062265625*^9, 3.448522079515625*^9}, 3.44852210984375*^9, 
   3.44852219125*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"n_", "/;", 
    RowBox[{"OddQ", "[", "n", "]"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "3"}], "}"}], "//.", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}], "/;", 
     RowBox[{
      RowBox[{"c", "\[NotEqual]", "0"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[NotEqual]", "1"}], "||", 
        RowBox[{"b", "\[NotEqual]", "1"}], "||", 
        RowBox[{"c", "\[NotEqual]", "1"}]}], ")"}]}]}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"b", ",", "c", ",", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"a", "+", "b", "+", "c"}], ",", "n"}], "]"}]}], 
     "}"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NestList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NestWhile", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "+", "2"}], "&"}], ",", 
       RowBox[{"#1", "+", "2"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "@", 
          RowBox[{"f", "[", "#", "]"}]}], "\[Equal]", "0"}], "&"}]}], "]"}], 
     "&"}], ",", "27", ",", "50"}], "]"}], "//", "Timing"}]}], "Input",
 CellChangeTimes->{{3.44852213678125*^9, 3.448522137015625*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7.218999999999994`", ",", 
   RowBox[{"{", 
    RowBox[{
    "27", ",", "81", ",", "91", ",", "103", ",", "135", ",", "163", ",", 
     "189", ",", "199", ",", "203", ",", "221", ",", "243", ",", "247", ",", 
     "273", ",", "297", ",", "305", ",", "309", ",", "351", ",", "371", ",", 
     "377", ",", "397", ",", "405", ",", "421", ",", "455", ",", "459", ",", 
     "489", ",", "513", ",", "515", ",", "551", ",", "559", ",", "567", ",", 
     "597", ",", "609", ",", "621", ",", "637", ",", "663", ",", "675", ",", 
     "721", ",", "729", ",", "741", ",", "757", ",", "779", ",", "783", ",", 
     "815", ",", "819", ",", "837", ",", "883", ",", "891", ",", "915", ",", 
     "927", ",", "945", ",", "991"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.44852220275*^9}]
}, Open  ]]
},
WindowSize->{615, 527},
WindowMargins->{{166, Automatic}, {Automatic, 21}},
FrontEndVersion->"6.0 for Microsoft Windows (32-bit) (May 21, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[568, 21, 866, 23, 52, "Input"],
Cell[1437, 46, 1148, 29, 72, "Input"],
Cell[CellGroupData[{
Cell[2610, 79, 995, 26, 72, "Input"],
Cell[3608, 107, 336, 5, 30, "Output"]
}, Open  ]],
Cell[3959, 115, 233, 4, 31, "Input"],
Cell[4195, 121, 397, 9, 31, "Input"],
Cell[CellGroupData[{
Cell[4617, 134, 1245, 37, 112, "Input"],
Cell[5865, 173, 300, 5, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6202, 183, 1876, 54, 212, "Input"],
Cell[8081, 239, 2026, 31, 202, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10144, 275, 1264, 39, 112, "Input"],
Cell[11411, 316, 819, 14, 88, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
