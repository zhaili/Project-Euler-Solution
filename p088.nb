(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     14521,        356]
NotebookOptionsPosition[     13628,        322]
NotebookOutlinePosition[     13968,        337]
CellTagsIndexPosition[     13925,        334]
WindowFrame->Normal
ContainsDynamic->False*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num", "=", "9000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Scan", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"minn", "[", "#", "]"}], "=", "Infinity"}], ")"}], "&"}], ",", 
   RowBox[{"Range", "[", "num", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dfs", "[", 
   RowBox[{"last_", ",", "prod_", ",", "sum_", ",", "d_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k", "=", "last"}], ",", "r"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"r", "=", 
      RowBox[{
       RowBox[{"prod", "*", "k"}], "-", 
       RowBox[{"(", 
        RowBox[{"sum", "+", "k"}], ")"}], "+", "d"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"r", "\[LessEqual]", "num"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"minn", "[", "r", "]"}], "=", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"minn", "[", "r", "]"}], ",", 
           RowBox[{"prod", "*", "k"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"dfs", "[", 
         RowBox[{"k", ",", 
          RowBox[{"prod", "*", "k"}], ",", 
          RowBox[{"sum", "+", "k"}], ",", 
          RowBox[{"d", "+", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "++"}], ";", "\[IndentingNewLine]", 
        RowBox[{"r", "=", 
         RowBox[{
          RowBox[{"prod", "*", "k"}], "-", 
          RowBox[{"(", 
           RowBox[{"sum", "+", "k"}], ")"}], "+", "d"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Scan", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"dfs", "[", 
      RowBox[{"#", ",", "#", ",", "#", ",", "2"}], "]"}], "&"}], ",", 
    RowBox[{"Range", "[", 
     RowBox[{"2", ",", 
      RowBox[{
       RowBox[{"Sqrt", "[", "num", "]"}], "+", "1"}]}], "]"}]}], "]"}], "//", 
  "Timing"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Union", "[", 
   RowBox[{"minn", "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"2", ",", "num"}], "]"}]}], "]"}], "//", "Tr"}]}], "Input",
 CellChangeTimes->{{3.4481953980625*^9, 3.44819550996875*^9}, {
   3.448195590296875*^9, 3.4481955983125*^9}, {3.44819564534375*^9, 
   3.448195731734375*^9}, {3.448195774171875*^9, 3.44819603215625*^9}, {
   3.4481960673125*^9, 3.44819606903125*^9}, {3.44819615178125*^9, 
   3.4481961800625*^9}, {3.44819622315625*^9, 3.44819624671875*^9}, {
   3.448196278734375*^9, 3.44819627921875*^9}, {3.448196311203125*^9, 
   3.448196365734375*^9}, {3.448196410828125*^9, 3.448196521109375*^9}, {
   3.448196554609375*^9, 3.44819660146875*^9}, {3.448196653734375*^9, 
   3.44819668471875*^9}, {3.448196755234375*^9, 3.448196853859375*^9}, {
   3.44819688803125*^9, 3.448197026046875*^9}, 3.44819707778125*^9, {
   3.448197113375*^9, 3.448197156765625*^9}, {3.448197274765625*^9, 
   3.448197310859375*^9}, {3.44819739496875*^9, 3.448197477125*^9}, {
   3.44819751096875*^9, 3.44819767359375*^9}, {3.448197742484375*^9, 
   3.4481978595*^9}, {3.448198015*^9, 3.448198015390625*^9}, {
   3.44819805396875*^9, 3.448198094828125*^9}, {3.448198136578125*^9, 
   3.448198160359375*^9}, {3.4481981958125*^9, 3.44819827978125*^9}, {
   3.44819831034375*^9, 3.448198376125*^9}, {3.448198425140625*^9, 
   3.4481984324375*^9}, {3.448237352890625*^9, 3.448237353203125*^9}, {
   3.4482374820625*^9, 3.448237499015625*^9}, {3.448237544453125*^9, 
   3.448237566390625*^9}, {3.44823764290625*^9, 3.4482376450625*^9}, {
   3.4482377980625*^9, 3.44823780271875*^9}, {3.44823795303125*^9, 
   3.448237957609375*^9}, {3.448238034890625*^9, 3.44823804190625*^9}, 
   3.448245016859375*^9, {3.448245080421875*^9, 3.44824508884375*^9}, {
   3.448245175453125*^9, 3.448245176234375*^9}, {3.448245357328125*^9, 
   3.448245394359375*^9}, {3.44824551075*^9, 3.44824552115625*^9}, {
   3.4482461923125*^9, 3.448246192671875*^9}, {3.448246372546875*^9, 
   3.4482463730625*^9}, {3.448246414484375*^9, 3.4482464148125*^9}, {
   3.448246555125*^9, 3.4482465783125*^9}, {3.44824661775*^9, 
   3.44824662240625*^9}, {3.448246755296875*^9, 3.448246787515625*^9}, {
   3.448246849109375*^9, 3.448246852015625*^9}, {3.44824691771875*^9, 
   3.4482469380625*^9}, {3.448246984109375*^9, 3.448246988609375*^9}, {
   3.448247022109375*^9, 3.44824702584375*^9}, 3.44824890775*^9, {
   3.4482490116875*^9, 3.4482490945*^9}, {3.44824912715625*^9, 
   3.448249151875*^9}, {3.448249212921875*^9, 3.448249358875*^9}, {
   3.448249394*^9, 3.44824948775*^9}, {3.448249999453125*^9, 
   3.448250043421875*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10.452999999999994`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.4482455178125*^9, 3.448245541109375*^9}, 
   3.448246193296875*^9, 3.4482463744375*^9, 3.4482464156875*^9, {
   3.4482467883125*^9, 3.44824679334375*^9}, 3.4482468740625*^9, {
   3.448246952515625*^9, 3.44824703240625*^9}, 3.448248909046875*^9, {
   3.44824907678125*^9, 3.448249129984375*^9}, {3.448249251234375*^9, 
   3.448249327203125*^9}, {3.448249398203125*^9, 3.448249410578125*^9}, {
   3.448249456796875*^9, 3.44824950459375*^9}, {3.448250000125*^9, 
   3.4482500566875*^9}}],

Cell[BoxData["4476437"], "Output",
 CellChangeTimes->{{3.4482455178125*^9, 3.448245541109375*^9}, 
   3.448246193296875*^9, 3.4482463744375*^9, 3.4482464156875*^9, {
   3.4482467883125*^9, 3.44824679334375*^9}, 3.4482468740625*^9, {
   3.448246952515625*^9, 3.44824703240625*^9}, 3.448248909046875*^9, {
   3.44824907678125*^9, 3.448249129984375*^9}, {3.448249251234375*^9, 
   3.448249327203125*^9}, {3.448249398203125*^9, 3.448249410578125*^9}, {
   3.448249456796875*^9, 3.44824950459375*^9}, {3.448250000125*^9, 
   3.448250056734375*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"minn", "/@", 
  RowBox[{"Range", "[", 
   RowBox[{"2", ",", "num"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.44819770434375*^9, 3.44819774059375*^9}, {
   3.44819780403125*^9, 3.448197809140625*^9}, {3.448197885703125*^9, 
   3.44819791103125*^9}, 3.448197944*^9, {3.448197978453125*^9, 
   3.448197978984375*^9}, {3.44819802603125*^9, 3.44819803965625*^9}, {
   3.448198397046875*^9, 3.44819840859375*^9}, {3.448237363578125*^9, 
   3.448237395734375*^9}, {3.448237505140625*^9, 3.4482375185625*^9}, {
   3.448237828015625*^9, 3.448237862625*^9}, {3.448237924015625*^9, 
   3.448237938609375*^9}, {3.44824512328125*^9, 3.4482451259375*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4", ",", "6", ",", "8", ",", "8", ",", "12", ",", "12", ",", "12", ",", 
   "15", ",", "16", ",", "16", ",", "16", ",", "18", ",", "20", ",", "24", 
   ",", "24", ",", "24", ",", "24", ",", "24", ",", "28", ",", "27", ",", 
   "32", ",", "30", ",", "48", ",", "32", ",", "32", ",", "32", ",", "36", 
   ",", "36", ",", "36", ",", "42", ",", "40", ",", "40", ",", "48", ",", 
   "48", ",", "48", ",", "45", ",", "48", ",", "48", ",", "48", ",", "48", 
   ",", "48", ",", "54", ",", "60", ",", "54", ",", "56", ",", "54", ",", 
   "60", ",", "63", ",", "60", ",", "60", ",", "60", ",", "63", ",", "64", 
   ",", "64", ",", "64", ",", "64", ",", "64", ",", "70", ",", "72", ",", 
   "72", ",", "72", ",", "72", ",", "72", ",", "72", ",", "84", ",", "80", 
   ",", "80", ",", "81", ",", "80", ",", "80", ",", "80", ",", "81", ",", 
   "84", ",", "88", ",", "96", ",", "90", ",", "96", ",", "90", ",", "108", 
   ",", "90", ",", "96", ",", "96", ",", "96", ",", "96", ",", "96", ",", 
   "96", ",", "96", ",", "96", ",", "100", ",", "110", ",", "112", ",", "105",
    ",", "108", ",", "108", ",", "108", ",", "117", ",", "108", ",", "108", 
   ",", "108", ",", "112", ",", "112", ",", "120", ",", "120", ",", "120", 
   ",", "120", ",", "120", ",", "120", ",", "120", ",", "120", ",", "120", 
   ",", "152", ",", "125", ",", "228", ",", "126", ",", "128", ",", "128", 
   ",", "128", ",", "128", ",", "128"}], "}"}]], "Output",
 CellChangeTimes->{
  3.448246418390625*^9, {3.448246844921875*^9, 3.448246845890625*^9}, {
   3.448246992796875*^9, 3.448247031015625*^9}, 3.448247553703125*^9, {
   3.448247584828125*^9, 3.44824762771875*^9}, {3.44824767534375*^9, 
   3.44824772275*^9}, {3.448247757078125*^9, 3.448247764390625*^9}, 
   3.44824780140625*^9, {3.448248882703125*^9, 3.448248883734375*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"7599525", "-", "7587457"}]], "Input",
 CellChangeTimes->{{3.44819847640625*^9, 3.44819847653125*^9}}],

Cell[BoxData["12068"], "Output",
 CellChangeTimes->{3.448198476859375*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",",
   "2", ",", "2", ",", "2", ",", "2"}]], "Input",
 CellChangeTimes->{{3.44819557328125*^9, 3.44819557646875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "a__", "]"}], ":=", 
  RowBox[{
   RowBox[{"Times", "[", "a", "]"}], "+", 
   RowBox[{"Plus", "[", "a", "]"}], "-", 
   RowBox[{"Length", "[", 
    RowBox[{"{", "a", "}"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.44819560815625*^9, 3.448195630625*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.448247187484375*^9, 3.448247289890625*^9}, {
  3.448247346515625*^9, 3.448247425171875*^9}, {3.44824745865625*^9, 
  3.448247578765625*^9}, {3.4482476643125*^9, 3.44824766834375*^9}, {
  3.44824770303125*^9, 3.44824770325*^9}, {3.44824774053125*^9, 
  3.4482477459375*^9}, {3.44824778790625*^9, 3.4482477930625*^9}, {
  3.448248635765625*^9, 3.448248902984375*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "9000"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"range", "=", 
   RowBox[{"n", "*", "2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"minAnswer", "[", "i", "]"}], "=", "Infinity"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dfs", "[", 
    RowBox[{"num_", ",", "prod_", ",", "sum_", ",", "last_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"2", "\[LessEqual]", 
         RowBox[{"prod", "-", "sum", "+", "num"}], "\[LessEqual]", "n"}], ",",
         
        RowBox[{
         RowBox[{"minAnswer", "[", 
          RowBox[{"prod", "-", "sum", "+", "num"}], "]"}], "=", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"minAnswer", "[", 
            RowBox[{"prod", "-", "sum", "+", "num"}], "]"}], ",", "prod"}], 
          "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "last"}], ",", 
        RowBox[{
         RowBox[{"prod", "*", "i"}], "\[LessEqual]", "range"}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{"dfs", "[", 
         RowBox[{
          RowBox[{"num", "+", "1"}], ",", 
          RowBox[{"prod", "*", "i"}], ",", 
          RowBox[{"sum", "+", "i"}], ",", "i"}], "]"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"dfs", "[", 
      RowBox[{"1", ",", "first", ",", "first", ",", "first"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"first", ",", "2", ",", "range"}], "}"}]}], "]"}], ";"}], "//", 
  "Timing"}], "\n", 
 RowBox[{
  RowBox[{"Union", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"minAnswer", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "n"}], "}"}]}], "]"}], "]"}], "//", 
  "Tr"}]}], "Input",
 CellChangeTimes->{{3.4482476011875*^9, 3.448247606921875*^9}, {
   3.4482489145625*^9, 3.4482489185*^9}, {3.448249102546875*^9, 
   3.44824912215625*^9}, 3.44824915390625*^9, {3.4482492783125*^9, 
   3.448249279828125*^9}, {3.448249497796875*^9, 3.448249502015625*^9}, {
   3.448250052921875*^9, 3.448250053484375*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"12.374999999999995`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.448247602328125*^9, 3.44824760759375*^9}, {
   3.4482477498125*^9, 3.448247750703125*^9}, 3.448248887625*^9, 
   3.448248918859375*^9, {3.448249105171875*^9, 3.44824912365625*^9}, {
   3.44824927571875*^9, 3.44824928775*^9}, {3.448249322703125*^9, 
   3.448249330828125*^9}, 3.44824946040625*^9, 3.448249529390625*^9, 
   3.4482500995625*^9}],

Cell[BoxData["4476437"], "Output",
 CellChangeTimes->{{3.448247602328125*^9, 3.44824760759375*^9}, {
   3.4482477498125*^9, 3.448247750703125*^9}, 3.448248887625*^9, 
   3.448248918859375*^9, {3.448249105171875*^9, 3.44824912365625*^9}, {
   3.44824927571875*^9, 3.44824928775*^9}, {3.448249322703125*^9, 
   3.448249330828125*^9}, 3.44824946040625*^9, 3.448249529390625*^9, 
   3.448250099625*^9}]
}, Open  ]]
},
WindowSize->{615, 640},
WindowMargins->{{157, Automatic}, {Automatic, 0}},
FrontEndVersion->"6.0 for Microsoft Windows (32-bit) (May 21, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[590, 23, 4762, 102, 292, "Input"],
Cell[5355, 127, 601, 10, 30, "Output"],
Cell[5959, 139, 543, 8, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6539, 152, 666, 11, 31, "Input"],
Cell[7208, 165, 1839, 27, 145, "Output"]
}, Open  ]],
Cell[9062, 195, 73, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[9160, 200, 125, 2, 31, "Input"],
Cell[9288, 204, 74, 1, 30, "Output"]
}, Open  ]],
Cell[9377, 208, 206, 3, 31, "Input"],
Cell[9586, 213, 299, 8, 31, "Input"],
Cell[9888, 223, 414, 6, 31, "Input"],
Cell[CellGroupData[{
Cell[10327, 233, 2422, 68, 212, "Input"],
Cell[12752, 303, 459, 8, 30, "Output"],
Cell[13214, 313, 398, 6, 30, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
